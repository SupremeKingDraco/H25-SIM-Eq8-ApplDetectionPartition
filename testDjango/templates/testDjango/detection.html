<!DOCTYPE html>
{% load static %}

<html lang="fr">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Detection</title>
    <link rel="stylesheet" href="{% static 'css/traducteurPage.css' %}">
    <script src="{% static 'js/main.js' %}" defer></script>
    <!-- Bouton Fixe -->
    <button class="fixed-button">Partition</button>
    <style>
        #display-area {
            background-color: white;
            padding: 20px;
            margin-top: 20px;
            color: black; /* Assure que le texte est en noir */
        }
        #input-data {
            white-space: pre-wrap; /* Préserve les espaces et les retours à la ligne */
            word-wrap: break-word; /* Coupe les mots longs */
        }
    </style>
</head>
<body>

<!-- Arrière-plan Vidéo -->
<div class="video-background">
  <video autoplay muted loop>
    <source src="{% static 'image/web page final background.mp4' %}" type="video/mp4">
    Votre navigateur ne supporte pas la balise vidéo.
  </video>
</div>

<div style="background-color: rgba(0, 0, 0, 0.8); width: 1300px;height: 700px;">
    <h3> Bonjour et bienvenu à notre détecteur de partition</h3>

    <label for="userInput">Entrez votre texte :</label>
    <input type="text" id="userInput" name="userInput" placeholder="Tapez ici...">
    <hr>
    <p class="btn-group">
        <button style="width:50%" id="button1" onclick="handleButtonClick(4)">Traitement image</button>
        <button style="width:50%" id="button2" onclick="handleButtonClick(1)">Traitement audio</button>
    </p>
    <!-- Conteneur pour les champs d'entrée dynamiques -->
    <div id="dynamic-inputs" class="input-container"></div>
</div>

<!-- Zone d'affichage pour les données d'entrée -->
<div id="display-area">
    <h4>Données d'entrée :</h4>
    <pre id="input-data"></pre>
</div>

<!-- Bouton de Soumission -->
<button id="submitButton">Soumettre</button>

<script>
  let treatmentSelected = false;

  /**
   * Fonction pour créer des champs de texte dynamiques
   * @param {number} count - Nombre de champs d'entrée à créer
   */
  function createInputs(count) {
    // Efface les champs d'entrée précédemment créés
    const inputContainer = document.getElementById('dynamic-inputs');
    inputContainer.innerHTML = '';

    // Définit tagName en fonction du compte
    let tagName = [];
    if (count == 1) {
        tagName = ["Selectionner le seuil de décibel. (recommander entre -40 et -10)"];
    } else if (count == 4) {
        tagName = ["bpm", "nombre bemole/ diez", "premiere note ex: La","premiere octave ex: 4"];
    }

    // Crée le nombre spécifié de champs d'entrée
    for (let i = 0; i < count; i++) {
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = tagName[i];

        // Ajuste dynamiquement la taille de la police et la largeur pour count == 1
        if (count == 1) {
            input.style.fontSize = "20px"; // Augmente la taille de la police pour une meilleure visibilité
            input.style.width = `${tagName[i].length * 10}px`; // Ajuste la largeur en fonction de la longueur du texte du placeholder
        }

        inputContainer.appendChild(input);
    }

    // Définit treatmentSelected sur true lorsque les champs d'entrée sont créés
    treatmentSelected = true;
}

  /**
   * Fonction pour gérer les événements de clic sur les boutons
   * @param {number} count - Nombre de champs d'entrée à créer
   */
  function handleButtonClick(count) {
    createInputs(count);
  }

  /**
   * Fonction pour récupérer les données d'entrée de la page
   */
  function retrieveInputData() {
    // Vérifie si une option de traitement a été sélectionnée
    if (!treatmentSelected) {
      alert("Veuillez d'abord sélectionner une option de traitement.");
      return;
    }

    // Récupère la valeur du champ d'entrée statique
    const userInput = document.getElementById('userInput').value;
    if (userInput.trim() === "") {
      alert("Veuillez entrer du texte dans le champ d'entrée.");
      return;
    }

    // Récupère les valeurs des champs d'entrée dynamiques
    const dynamicInputs = document.querySelectorAll('#dynamic-inputs input');
    const dynamicInputValues = [];
    let allInputsFilled = true;

    dynamicInputs.forEach((input, index) => {
      if (input.value.trim() === "") {
        allInputsFilled = false;
      }
      dynamicInputValues.push(input.value);
    });

    if (!allInputsFilled) {
      alert("Veuillez remplir tous les champs d'entrée dynamiques.");
      return;
    }

    // Affiche les données dans la zone d'affichage
    displayInputData(userInput, dynamicInputValues);

    // Traite les données si nécessaire
    processData(userInput, dynamicInputs);
  }

  /**
   * Fonction pour afficher les données d'entrée sur la page web
   * @param {string} userInput - Valeur du champ d'entrée statique
   * @param {array} dynamicInputValues - Valeurs des champs d'entrée dynamiques
   */
  function displayInputData(userInput, dynamicInputValues) {
    const displayArea = document.getElementById('input-data');
    displayArea.innerHTML = `Entrée Utilisateur : ${userInput}\n`;
    dynamicInputValues.forEach((value, index) => {
      displayArea.innerHTML += `Entrée Dynamique ${index + 1} : ${value}\n`;
    });
  }

  /**
   * Fonction pour traiter les données récupérées
   * @param {string} userInput - Valeur du champ d'entrée statique
   * @param {NodeList} dynamicInputs - Valeurs des champs d'entrée dynamiques
   */
  function processData(userInput, dynamicInputs) {



  }

  // Ajoute un écouteur d'événements au bouton de soumissions
  document.getElementById('submitButton').addEventListener('click', () => {
    retrieveInputData();
  });
</script>

</body>
</html>
